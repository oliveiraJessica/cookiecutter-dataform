# CookieCutter Template Dataform Projects

[![python](https://img.shields.io/pypi/pyversions/cookiecutter.svg)](https://pypi.org/project/cookiecutter/)

## Project

This project was developed a create project templates in Dataform using the CookieCutter.

## Intro

### What's Dataform?

Dataform is an application to manage data in BigQuery, Snowflake, Redshift, and other data warehouses. It enables data teams to build scalable, tested, SQL based data transformation pipelines using version control and engineering inspired best practices.

* Documentation: [https://docs.dataform.co/](https://docs.dataform.co/)

### What's CookieCutter?

A command-line utility that creates projects from cookiecutters (project templates), e.g. creating a Python package project from a Python package project template.

* Documentation: [https://cookiecutter.readthedocs.io/en/1.7.2/index.html](https://cookiecutter.readthedocs.io/en/1.7.2/index.html)

## Usage

First, clone a Cookiecutter project template:

```bash
    $ git clone git@github.com:oliveiraJessica/cookiecutter-dataform.git
```

Install the latest Cookiecutter if you haven't installed it yet (this requires Cookiecutter 1.4.0 or higher):

```bash
    $ pip install -r requirements.txt
```

Then generate your project from the project template:

```bash
   $ cookiecutter cookiecutter-dataform/
```

The only argument is the input directory. (The output directory is generated by rendering that, and it can't be the same as the input directory.)


## Best Practices

This project considers it best practice  to keep development, piloto and production data separated. 


## Folder Structure

### Input

The project is structured in the main folders:

```shell
    ├── {{coockiecutter and "root"}} 
        ├── definitions
            ├── {%- if cookiecutter.enum_folders == "yes" -%} 00_{% endif %}source  
            ├── {%- if cookiecutter.enum_folders == "yes" -%} 01_{% endif %}staging 
            ├── {%- if cookiecutter.enum_folders == "yes" -%} 02_{% endif %}tests
            ├── {%- if cookiecutter.enum_folders == "yes" -%} 03_{% endif %}reports
        ├── includes   
        ├── dataform.json
        ├── environments.json
        ├── run.sh  
    ├── hooks 
        ├── post_gen_project.sh   
        ├── pre_gen_project.sh    
    ├── cookiecutter.json 
    ├── LICENSE 
    ├── README.md   
    ├── requirements.txt   
```

* **{{coockiecutter and "root"}}**: Directory names to template
  * **definitions**: Dataset is where you add the SQLX files that will define new tables, views, assertions (data quality tests) and other SQL operations that will run in your warehouse.
    * **{%- if cookiecutter.enum_folders == "yes" -%} 00_{% endif %}source**:Dataset this specific options can be applied to tables using the bigquery configuration parameter.
    * **{%- if cookiecutter.enum_folders == "yes" -%} 01_{% endif %}staging**: Dataset of intermediate data transformations.
    * **{%- if cookiecutter.enum_folders == "yes" -%} 02_{% endif %}tests**: Dataset this unit tests and assertions.
    * **{%- if cookiecutter.enum_folders == "yes" -%} 03_{% endif %}**: Dataset this reports modeling (facts and dimensions).
  * **includes**: is where you can add JS files where you define variables and functions that you can use across your entire project. 
  * **dataform.json**: File this configuration dataform folders, warehouse and name project.
  * **environments.json**: File this configuration environments {DEVELOP, PILOTO and PRODUCTION}.
  * **run.sh**: Shell script rename file *dataform.json* for *dataform_${ENVIROMENT}*. 
* **hooks**: Shell scripts that run before and after project is generated. 
  * **post_gen_project.sh**: Shell scripts that run after your project is generated.
  * **pre_gen_project.sh**:Shell scripts that run before  your project is generated.
* **cookiecutter.json**: File that defines the template execution variables.
* **LICENSE**: License as chosen on the command-line.
* **README.md**: The top-level README for developers.
* **requirements.txt**: Dependences your project.

### Output

During the generation of the project, some configuration parameters can be passed, such as the names of the environments or the possibilities of numbering the folders within definitions.

This project generates two outputs one with enums in the folder name and the other without enums:

* Output with numbered folders:

```shell
    ├── project_name                        
        ├── definitions
            ├── 00_source      
            ├── 01_staging   
            ├── 02_tests 
            ├── 03_reports 
        ├── includes   
        ├── dataform.json
        ├── dataform_develop.json
        ├── dataform_piloto.json
        ├── dataform_production.json
        ├── environments.json
        ├── run.sh 
    ├── README.md              
```

* Output with unnumbered folders:
  
```shell
    ├── project_name                        
        ├── definitions
            ├── source      
            ├── staging   
            ├── tests 
            ├── reports 
        ├── includes   
        ├── dataform.json
        ├── dataform_develop.json
        ├── dataform_piloto.json
        ├── dataform_production.json
        ├── environments.json
        ├── run.sh 
    ├── README.md              
```
